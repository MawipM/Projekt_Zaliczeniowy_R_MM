---
title: "Analiza Danych - Samochody"
author: "Maciej Małecki"
date: "2025-01-10"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## Wstęp

W tej sekcji zajmiemy się analizą zbioru danych `mpg`, który jest dostępny w pakiecie `ggplot2`. Zbiór ten zawiera dane o zużyciu paliwa dla popularnych modeli samochodów z lat 1999 i 2008.

### Wczytanie pakietów

Na początku wczytujemy niezbędne biblioteki.

```{r wczytanie_danych, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)

# Przetwarzanie danych
dane_auta <- mpg %>%
  mutate(spalanie_l100km = 235 / hwy)

auta_2008 <- dane_auta %>%
  filter(year == 2008)

wyniki <- auta_2008 %>%
  group_by(class) %>%
  summarise(srednie_spalanie = mean(spalanie_l100km)) %>%
  arrange(desc(srednie_spalanie))

knitr::kable(wyniki, caption = "Średnie spalanie wg klasy auta")
```

### Wykres 1: Histogram spalania

```{r wykres_histogram, message=FALSE, warning=FALSE}
ggplot(auta_2008, aes(x = spalanie_l100km)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black") +
  labs(title = "Rozkład spalania paliwa",
       x = "Litry na 100 km",
       y = "Liczba aut") +
  theme_minimal()
```

**Komentarz:** Najwięcej aut spala w przedziale 8-12 litrów na 100 km.

### Wykres 2: Liczebność klas samochodów

```{r wykres_slupkowy, message=FALSE, warning=FALSE}
ggplot(auta_2008, aes(x = class)) +
  geom_bar(fill = "darkblue") +
  labs(title = "Liczba aut w poszczególnych klasach",
       x = "Klasa",
       y = "Liczba") +
  theme_minimal()
```

**Komentarz:** W analizowanym roczniku dominuje klasa SUV.

### Wykres 3: Zależność pojemności silnika od klasy

```{r wykres_boxplot, message=FALSE, warning=FALSE}
ggplot(auta_2008, aes(x = class, y = displ, fill = class)) +
  geom_boxplot() +
  labs(title = "Pojemność silnika a klasa auta",
       x = "Klasa",
       y = "Pojemność silnika (litry)") +
  theme_minimal() +
  theme(legend.position = "none")
```

**Komentarz:** Samochody typu SUV i pickup mają największe silniki (mediana ok. 5 litrów), podczas gdy auta kompaktowe mają zazwyczaj silniki mniejsze (ok. 2-3 litry).
